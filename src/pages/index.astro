---
import BaseLayout from '../layouts/BaseLayout.astro';
import FormattedDate from '../components/FormattedDate.astro';
import { getCollection } from 'astro:content';

const articles = (await getCollection('articles'))
	.filter((article) => article.data.published)
	.sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf())
	.slice(0, 5);

const logs = (await getCollection('logs'))
	.filter((log) => log.data.published)
	.sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf())
	.slice(0, 5);
---

<BaseLayout title="Feedback" description="A markdown-first thinking space.">
	<section class="mb-16">
		<h1 class="text-xl font-bold mb-2">Feedback</h1>
		<div class="text-secondary text-lg leading-relaxed">
			<p>A public loop for personal logs and refined articles. Also some dumb stuff I do.</p>
			<p>Notes for everything that my mind goes through. From Robotics, AGI, to my daily thoughts, observations about people, philosophy and future of humanity maybe?</p>

		</div>
	</section>

	<section class="mb-16">
		<h2 class="text-sm font-semibold uppercase tracking-wider text-secondary mb-6 border-b border-border pb-2">Articles</h2>
		<ul class="space-y-4">
			{articles.map((article) => (
				<li class="flex justify-between items-baseline group">
					<a href={`/articles/${article.slug}/`} class="text-lg font-serif font-semibold group-hover:text-accent transition-colors">
						{article.data.title}
					</a>
					<span class="text-sm font-mono text-secondary"><FormattedDate date={article.data.date} /></span>
				</li>
			))}
		</ul>
		<div class="mt-6 text-sm">
			<a href="/articles" class="text-secondary hover:text-accent transition-colors">View all articles →</a>
		</div>
	</section>

	<section class="mb-16">
		<h2 class="text-sm font-semibold uppercase tracking-wider text-secondary mb-6 border-b border-border pb-2">Recent Logs</h2>
		<ul class="space-y-3">
			{logs.map((log) => (
				<li>
					<a href={`/logs/${log.slug}/`} class="flex flex-col sm:flex-row sm:items-baseline gap-2 sm:gap-4 group font-mono text-sm group">
						<div class="flex items-baseline gap-4 min-w-[200px]">
							<span class="text-secondary min-w-[3ch] group-hover:text-accent transition-colors">#{log.data.log_number}</span>
							<span class="group-hover:text-accent transition-colors"><FormattedDate date={log.data.date} /></span>
						</div>
						{log.data.subtitle && (
							<span class="text-secondaryText text-xs italic group-hover:text-accent transition-colors sm:ml-4">
								{log.data.subtitle}
							</span>
						)}
					</a>
				</li>
			))}
		</ul>
		<div class="mt-6 text-sm">
			<a href="/logs" class="text-secondary hover:text-accent transition-colors">View all logs →</a>
		</div>
	</section>
</BaseLayout>
